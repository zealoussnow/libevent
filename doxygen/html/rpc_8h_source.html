<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>libevent: event2/rpc.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<h1>event2/rpc.h</h1><a href="rpc_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> * Copyright (c) 2006-2007 Niels Provos &lt;provos@citi.umich.edu&gt;</span>
<a name="l00003"></a>00003 <span class="comment"> * Copyright (c) 2007-2012 Niels Provos and Nick Mathewson</span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> * Redistribution and use in source and binary forms, with or without</span>
<a name="l00006"></a>00006 <span class="comment"> * modification, are permitted provided that the following conditions</span>
<a name="l00007"></a>00007 <span class="comment"> * are met:</span>
<a name="l00008"></a>00008 <span class="comment"> * 1. Redistributions of source code must retain the above copyright</span>
<a name="l00009"></a>00009 <span class="comment"> *    notice, this list of conditions and the following disclaimer.</span>
<a name="l00010"></a>00010 <span class="comment"> * 2. Redistributions in binary form must reproduce the above copyright</span>
<a name="l00011"></a>00011 <span class="comment"> *    notice, this list of conditions and the following disclaimer in the</span>
<a name="l00012"></a>00012 <span class="comment"> *    documentation and/or other materials provided with the distribution.</span>
<a name="l00013"></a>00013 <span class="comment"> * 3. The name of the author may not be used to endorse or promote products</span>
<a name="l00014"></a>00014 <span class="comment"> *    derived from this software without specific prior written permission.</span>
<a name="l00015"></a>00015 <span class="comment"> *</span>
<a name="l00016"></a>00016 <span class="comment"> * THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS&apos;&apos; AND ANY EXPRESS OR</span>
<a name="l00017"></a>00017 <span class="comment"> * IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES</span>
<a name="l00018"></a>00018 <span class="comment"> * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.</span>
<a name="l00019"></a>00019 <span class="comment"> * IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,</span>
<a name="l00020"></a>00020 <span class="comment"> * INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT</span>
<a name="l00021"></a>00021 <span class="comment"> * NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<a name="l00022"></a>00022 <span class="comment"> * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<a name="l00023"></a>00023 <span class="comment"> * THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00024"></a>00024 <span class="comment"> * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF</span>
<a name="l00025"></a>00025 <span class="comment"> * THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00026"></a>00026 <span class="comment"> */</span>
<a name="l00027"></a>00027 <span class="preprocessor">#ifndef _EVENT2_RPC_H_</span>
<a name="l00028"></a>00028 <span class="preprocessor"></span><span class="preprocessor">#define _EVENT2_RPC_H_</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span>
<a name="l00030"></a>00030 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00076"></a><a class="code" href="rpc_8h.html#a1a924e89c7a0c5eddc63cf9bf569fae6">00076</a> <span class="preprocessor">#define EVTAG_HAS(msg, member) \</span>
<a name="l00077"></a>00077 <span class="preprocessor">        ((msg)-&gt;member##_set == 1)</span>
<a name="l00078"></a>00078 <span class="preprocessor"></span>
<a name="l00079"></a>00079 <span class="preprocessor">#ifndef _EVENT2_RPC_COMPAT_H_</span>
<a name="l00080"></a>00080 <span class="preprocessor"></span>
<a name="l00088"></a><a class="code" href="rpc_8h.html#a8063c9f0927da79cc9e53600a77eecc6">00088</a> <span class="preprocessor">#define EVTAG_ASSIGN(msg, member, value) \</span>
<a name="l00089"></a>00089 <span class="preprocessor">        (*(msg)-&gt;base-&gt;member##_assign)((msg), (value))</span>
<a name="l00090"></a>00090 <span class="preprocessor"></span>
<a name="l00098"></a><a class="code" href="rpc_8h.html#af420133e56a545bef6cba6f878d403d7">00098</a> <span class="preprocessor">#define EVTAG_ASSIGN_WITH_LEN(msg, member, value, len)  \</span>
<a name="l00099"></a>00099 <span class="preprocessor">        (*(msg)-&gt;base-&gt;member##_assign)((msg), (value), (len))</span>
<a name="l00100"></a>00100 <span class="preprocessor"></span>
<a name="l00108"></a><a class="code" href="rpc_8h.html#aef6e54053208c090c43d05c9b2259fb9">00108</a> <span class="preprocessor">#define EVTAG_GET(msg, member, pvalue) \</span>
<a name="l00109"></a>00109 <span class="preprocessor">        (*(msg)-&gt;base-&gt;member##_get)((msg), (pvalue))</span>
<a name="l00110"></a>00110 <span class="preprocessor"></span>
<a name="l00119"></a><a class="code" href="rpc_8h.html#ae0b73ea41cb7f06976fd69a8f1be6219">00119</a> <span class="preprocessor">#define EVTAG_GET_WITH_LEN(msg, member, pvalue, plen)   \</span>
<a name="l00120"></a>00120 <span class="preprocessor">        (*(msg)-&gt;base-&gt;member##_get)((msg), (pvalue), (plen))</span>
<a name="l00121"></a>00121 <span class="preprocessor"></span>
<a name="l00122"></a>00122 <span class="preprocessor">#endif  </span><span class="comment">/* _EVENT2_RPC_COMPAT_H_ */</span>
<a name="l00123"></a>00123 
<a name="l00127"></a><a class="code" href="rpc_8h.html#a796d8c44ee666b13ecbae36b0897820b">00127</a> <span class="preprocessor">#define EVTAG_ARRAY_ADD_VALUE(msg, member, value) \</span>
<a name="l00128"></a>00128 <span class="preprocessor">        (*(msg)-&gt;base-&gt;member##_add)((msg), (value))</span>
<a name="l00129"></a>00129 <span class="preprocessor"></span>
<a name="l00132"></a><a class="code" href="rpc_8h.html#a8bd4b0f338823bffee3ead3885ea6791">00132</a> <span class="preprocessor">#define EVTAG_ARRAY_ADD(msg, member) \</span>
<a name="l00133"></a>00133 <span class="preprocessor">        (*(msg)-&gt;base-&gt;member##_add)(msg)</span>
<a name="l00134"></a>00134 <span class="preprocessor"></span>
<a name="l00137"></a><a class="code" href="rpc_8h.html#a1b955ffe442d49fdfe17c76a6e758880">00137</a> <span class="preprocessor">#define EVTAG_ARRAY_GET(msg, member, offset, pvalue)    \</span>
<a name="l00138"></a>00138 <span class="preprocessor">        (*(msg)-&gt;base-&gt;member##_get)((msg), (offset), (pvalue))</span>
<a name="l00139"></a>00139 <span class="preprocessor"></span>
<a name="l00142"></a><a class="code" href="rpc_8h.html#ab4a0a6a9f8fbe20ced71eaebd297168b">00142</a> <span class="preprocessor">#define EVTAG_ARRAY_LEN(msg, member) ((msg)-&gt;member##_length)</span>
<a name="l00143"></a>00143 <span class="preprocessor"></span>
<a name="l00144"></a>00144 
<a name="l00145"></a>00145 <span class="keyword">struct </span><a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a>;
<a name="l00146"></a>00146 <span class="keyword">struct </span><a class="code" href="structevent__base.html" title="Structure to hold information and state for a Libevent dispatch loop.">event_base</a>;
<a name="l00147"></a>00147 <span class="keyword">struct </span>evrpc_req_generic;
<a name="l00148"></a>00148 <span class="keyword">struct </span>evrpc_request_wrapper;
<a name="l00149"></a>00149 <span class="keyword">struct </span>evrpc;
<a name="l00150"></a>00150 
<a name="l00155"></a><a class="code" href="rpc_8h.html#ae9eff66229e154543551a936c59dd8fa">00155</a> <span class="preprocessor">#define EVRPC_STRUCT(rpcname) struct evrpc_req__##rpcname</span>
<a name="l00156"></a>00156 <span class="preprocessor"></span>
<a name="l00157"></a>00157 <span class="keyword">struct </span>evhttp_request;
<a name="l00158"></a>00158 <span class="keyword">struct </span>evrpc_status;
<a name="l00159"></a>00159 <span class="keyword">struct </span>evrpc_hook_meta;
<a name="l00160"></a>00160 
<a name="l00172"></a><a class="code" href="rpc_8h.html#aa526799df545537b2dc67358b0dfaa15">00172</a> <span class="preprocessor">#define EVRPC_HEADER(rpcname, reqstruct, rplystruct) \</span>
<a name="l00173"></a>00173 <span class="preprocessor">EVRPC_STRUCT(rpcname) { \</span>
<a name="l00174"></a>00174 <span class="preprocessor">        struct evrpc_hook_meta *hook_meta; \</span>
<a name="l00175"></a>00175 <span class="preprocessor">        struct reqstruct* request; \</span>
<a name="l00176"></a>00176 <span class="preprocessor">        struct rplystruct* reply; \</span>
<a name="l00177"></a>00177 <span class="preprocessor">        struct evrpc* rpc; \</span>
<a name="l00178"></a>00178 <span class="preprocessor">        struct evhttp_request* http_req; \</span>
<a name="l00179"></a>00179 <span class="preprocessor">        struct evbuffer* rpc_data; \</span>
<a name="l00180"></a>00180 <span class="preprocessor">};                                                                   \</span>
<a name="l00181"></a>00181 <span class="preprocessor">int evrpc_send_request_##rpcname(struct evrpc_pool *, \</span>
<a name="l00182"></a>00182 <span class="preprocessor">    struct reqstruct *, struct rplystruct *, \</span>
<a name="l00183"></a>00183 <span class="preprocessor">    void (*)(struct evrpc_status *, \</span>
<a name="l00184"></a>00184 <span class="preprocessor">        struct reqstruct *, struct rplystruct *, void *cbarg),  \</span>
<a name="l00185"></a>00185 <span class="preprocessor">    void *);</span>
<a name="l00186"></a>00186 <span class="preprocessor"></span>
<a name="l00187"></a>00187 <span class="keyword">struct </span>evrpc_pool;
<a name="l00188"></a>00188 
<a name="l00190"></a>00190 <span class="keyword">struct </span>evrpc_request_wrapper *<a class="code" href="rpc_8h.html#a83b3d3ddadb971e808f5e37bc4eb61bc" title="use EVRPC_GENERATE instead">evrpc_make_request_ctx</a>(
<a name="l00191"></a>00191         <span class="keyword">struct</span> evrpc_pool *pool, <span class="keywordtype">void</span> *request, <span class="keywordtype">void</span> *reply,
<a name="l00192"></a>00192         <span class="keyword">const</span> <span class="keywordtype">char</span> *rpcname,
<a name="l00193"></a>00193         <span class="keywordtype">void</span> (*req_marshal)(<span class="keyword">struct</span> <a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a>*, <span class="keywordtype">void</span> *),
<a name="l00194"></a>00194         <span class="keywordtype">void</span> (*rpl_clear)(<span class="keywordtype">void</span> *),
<a name="l00195"></a>00195         <span class="keywordtype">int</span> (*rpl_unmarshal)(<span class="keywordtype">void</span> *, <span class="keyword">struct</span> <a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a> *),
<a name="l00196"></a>00196         <span class="keywordtype">void</span> (*cb)(<span class="keyword">struct</span> evrpc_status *, <span class="keywordtype">void</span> *, <span class="keywordtype">void</span> *, <span class="keywordtype">void</span> *),
<a name="l00197"></a>00197         <span class="keywordtype">void</span> *cbarg);
<a name="l00198"></a>00198 
<a name="l00213"></a>00213 <span class="preprocessor">#define EVRPC_MAKE_CTX(rpcname, reqstruct, rplystruct, \</span>
<a name="l00214"></a><a class="code" href="rpc_8h.html#ad7694fa8f1b5995a9d43bef1da170fad">00214</a> <span class="preprocessor">    pool, request, reply, cb, cbarg)                                    \</span>
<a name="l00215"></a>00215 <span class="preprocessor">        evrpc_make_request_ctx(pool, request, reply,                    \</span>
<a name="l00216"></a>00216 <span class="preprocessor">            #rpcname,                                                   \</span>
<a name="l00217"></a>00217 <span class="preprocessor">            (void (*)(struct evbuffer *, void *))reqstruct##_marshal,   \</span>
<a name="l00218"></a>00218 <span class="preprocessor">            (void (*)(void *))rplystruct##_clear,                       \</span>
<a name="l00219"></a>00219 <span class="preprocessor">            (int (*)(void *, struct evbuffer *))rplystruct##_unmarshal, \</span>
<a name="l00220"></a>00220 <span class="preprocessor">            (void (*)(struct evrpc_status *, void *, void *, void *))cb, \</span>
<a name="l00221"></a>00221 <span class="preprocessor">            cbarg)</span>
<a name="l00222"></a>00222 <span class="preprocessor"></span>
<a name="l00233"></a><a class="code" href="rpc_8h.html#af7abcafae087e3c4dce6a4cd85346114">00233</a> <span class="preprocessor">#define EVRPC_GENERATE(rpcname, reqstruct, rplystruct)                  \</span>
<a name="l00234"></a>00234 <span class="preprocessor">        int evrpc_send_request_##rpcname(struct evrpc_pool *pool,       \</span>
<a name="l00235"></a>00235 <span class="preprocessor">            struct reqstruct *request, struct rplystruct *reply,        \</span>
<a name="l00236"></a>00236 <span class="preprocessor">            void (*cb)(struct evrpc_status *,                           \</span>
<a name="l00237"></a>00237 <span class="preprocessor">                struct reqstruct *, struct rplystruct *, void *cbarg),  \</span>
<a name="l00238"></a>00238 <span class="preprocessor">            void *cbarg) {                                              \</span>
<a name="l00239"></a>00239 <span class="preprocessor">        return evrpc_send_request_generic(pool, request, reply, \</span>
<a name="l00240"></a>00240 <span class="preprocessor">            (void (*)(struct evrpc_status *, void *, void *, void *))cb, \</span>
<a name="l00241"></a>00241 <span class="preprocessor">            cbarg,                                                      \</span>
<a name="l00242"></a>00242 <span class="preprocessor">            #rpcname,                                                   \</span>
<a name="l00243"></a>00243 <span class="preprocessor">            (void (*)(struct evbuffer *, void *))reqstruct##_marshal,   \</span>
<a name="l00244"></a>00244 <span class="preprocessor">            (void (*)(void *))rplystruct##_clear,                       \</span>
<a name="l00245"></a>00245 <span class="preprocessor">            (int (*)(void *, struct evbuffer *))rplystruct##_unmarshal); \</span>
<a name="l00246"></a>00246 <span class="preprocessor">}</span>
<a name="l00247"></a>00247 <span class="preprocessor"></span>
<a name="l00257"></a><a class="code" href="rpc_8h.html#af78e1869994ee9597a9a0785d25fbf0b">00257</a> <span class="preprocessor">#define EVRPC_REQUEST_HTTP(rpc_req) (rpc_req)-&gt;http_req</span>
<a name="l00258"></a>00258 <span class="preprocessor"></span>
<a name="l00260"></a>00260 <span class="keywordtype">void</span> <a class="code" href="rpc_8h.html#aa8538456a93ddcbdf55755b88994d09a" title="completes the server response to an rpc request">evrpc_request_done</a>(<span class="keyword">struct</span> evrpc_req_generic *req);
<a name="l00261"></a>00261 
<a name="l00263"></a>00263 <span class="keywordtype">void</span> *<a class="code" href="rpc_8h.html#afa6dddd447a86803d27a7b069503576c" title="accessors for request and reply">evrpc_get_request</a>(<span class="keyword">struct</span> evrpc_req_generic *req);
<a name="l00264"></a>00264 <span class="keywordtype">void</span> *evrpc_get_reply(<span class="keyword">struct</span> evrpc_req_generic *req);
<a name="l00265"></a>00265 
<a name="l00274"></a><a class="code" href="rpc_8h.html#a36d6ba276baf3c95df69db35a2ef1527">00274</a> <span class="preprocessor">#define EVRPC_REQUEST_DONE(rpc_req) do { \</span>
<a name="l00275"></a>00275 <span class="preprocessor">  struct evrpc_req_generic *_req = (struct evrpc_req_generic *)(rpc_req); \</span>
<a name="l00276"></a>00276 <span class="preprocessor">  evrpc_request_done(_req);                                     \</span>
<a name="l00277"></a>00277 <span class="preprocessor">} while (0)</span>
<a name="l00278"></a>00278 <span class="preprocessor"></span>
<a name="l00279"></a>00279 
<a name="l00280"></a>00280 <span class="keyword">struct </span>evrpc_base;
<a name="l00281"></a>00281 <span class="keyword">struct </span>evhttp;
<a name="l00282"></a>00282 
<a name="l00283"></a>00283 <span class="comment">/* functions to start up the rpc system */</span>
<a name="l00284"></a>00284 
<a name="l00291"></a>00291 <span class="keyword">struct </span>evrpc_base *<a class="code" href="rpc_8h.html#aca904025a4a1cb8d22164da3afe32b5a" title="Creates a new rpc base from which RPC requests can be received.">evrpc_init</a>(<span class="keyword">struct</span> evhttp *server);
<a name="l00292"></a>00292 
<a name="l00301"></a>00301 <span class="keywordtype">void</span> <a class="code" href="rpc_8h.html#a64a8951f0d52f698a96808f276b32f39" title="Frees the evrpc base.">evrpc_free</a>(<span class="keyword">struct</span> evrpc_base *base);
<a name="l00302"></a>00302 
<a name="l00319"></a><a class="code" href="rpc_8h.html#abb204281e2555a1e91ff3885747d0533">00319</a> <span class="preprocessor">#define EVRPC_REGISTER(base, name, request, reply, callback, cbarg)     \</span>
<a name="l00320"></a>00320 <span class="preprocessor">        evrpc_register_generic(base, #name,                             \</span>
<a name="l00321"></a>00321 <span class="preprocessor">            (void (*)(struct evrpc_req_generic *, void *))callback, cbarg, \</span>
<a name="l00322"></a>00322 <span class="preprocessor">            (void *(*)(void *))request##_new, NULL,                     \</span>
<a name="l00323"></a>00323 <span class="preprocessor">            (void (*)(void *))request##_free,                           \</span>
<a name="l00324"></a>00324 <span class="preprocessor">            (int (*)(void *, struct evbuffer *))request##_unmarshal,    \</span>
<a name="l00325"></a>00325 <span class="preprocessor">            (void *(*)(void *))reply##_new, NULL,                       \</span>
<a name="l00326"></a>00326 <span class="preprocessor">            (void (*)(void *))reply##_free, \</span>
<a name="l00327"></a>00327 <span class="preprocessor">            (int (*)(void *))reply##_complete, \</span>
<a name="l00328"></a>00328 <span class="preprocessor">            (void (*)(struct evbuffer *, void *))reply##_marshal)</span>
<a name="l00329"></a>00329 <span class="preprocessor"></span>
<a name="l00337"></a>00337 <span class="keywordtype">int</span> <a class="code" href="rpc_8h.html#abaa7d70da1d9fdcb767279b55944be65" title="Low level function for registering an RPC with a server.">evrpc_register_rpc</a>(<span class="keyword">struct</span> evrpc_base *, <span class="keyword">struct</span> evrpc *,
<a name="l00338"></a>00338     <span class="keywordtype">void</span> (*)(<span class="keyword">struct</span> evrpc_req_generic*, <span class="keywordtype">void</span> *), <span class="keywordtype">void</span> *);
<a name="l00339"></a>00339 
<a name="l00348"></a><a class="code" href="rpc_8h.html#ab646cdf50e026accddcd9fe23b35837b">00348</a> <span class="preprocessor">#define EVRPC_UNREGISTER(base, name) evrpc_unregister_rpc((base), #name)</span>
<a name="l00349"></a>00349 <span class="preprocessor"></span>
<a name="l00350"></a>00350 <span class="keywordtype">int</span> evrpc_unregister_rpc(<span class="keyword">struct</span> evrpc_base *base, <span class="keyword">const</span> <span class="keywordtype">char</span> *name);
<a name="l00351"></a>00351 
<a name="l00352"></a>00352 <span class="comment">/*</span>
<a name="l00353"></a>00353 <span class="comment"> * Client-side RPC support</span>
<a name="l00354"></a>00354 <span class="comment"> */</span>
<a name="l00355"></a>00355 
<a name="l00356"></a>00356 <span class="keyword">struct </span>evhttp_connection;
<a name="l00357"></a>00357 <span class="keyword">struct </span>evrpc_status;
<a name="l00358"></a>00358 
<a name="l00374"></a><a class="code" href="rpc_8h.html#aff0efcd7cb8b966256b5127960bd2c81">00374</a> <span class="preprocessor">#define EVRPC_MAKE_REQUEST(name, pool, request, reply, cb, cbarg)       \</span>
<a name="l00375"></a>00375 <span class="preprocessor">        evrpc_send_request_##name((pool), (request), (reply), (cb), (cbarg))</span>
<a name="l00376"></a>00376 <span class="preprocessor"></span>
<a name="l00388"></a>00388 <span class="keywordtype">int</span> <a class="code" href="rpc_8h.html#a1bc336c8cb4b87e77fd35c697420b3c5" title="Makes an RPC request based on the provided context.">evrpc_make_request</a>(<span class="keyword">struct</span> evrpc_request_wrapper *ctx);
<a name="l00389"></a>00389 
<a name="l00400"></a>00400 <span class="keyword">struct </span>evrpc_pool *<a class="code" href="rpc_8h.html#a8e87434603994a71d26676ddfb1e2033" title="creates an rpc connection pool">evrpc_pool_new</a>(<span class="keyword">struct</span> <a class="code" href="structevent__base.html" title="Structure to hold information and state for a Libevent dispatch loop.">event_base</a> *base);
<a name="l00406"></a>00406 <span class="keywordtype">void</span> <a class="code" href="rpc_8h.html#a8d3e64475898ca58fd93b7f8919b3a01" title="frees an rpc connection pool">evrpc_pool_free</a>(<span class="keyword">struct</span> evrpc_pool *pool);
<a name="l00407"></a>00407 
<a name="l00416"></a>00416 <span class="keywordtype">void</span> <a class="code" href="rpc_8h.html#a063d8c73017ee732c8930e9c6fa00026" title="Adds a connection over which rpc can be dispatched to the pool.">evrpc_pool_add_connection</a>(<span class="keyword">struct</span> evrpc_pool *pool,
<a name="l00417"></a>00417     <span class="keyword">struct</span> evhttp_connection *evcon);
<a name="l00418"></a>00418 
<a name="l00427"></a>00427 <span class="keywordtype">void</span> <a class="code" href="rpc_8h.html#a707034fc4c7ba1021dd081863797e6e7" title="Removes a connection from the pool.">evrpc_pool_remove_connection</a>(<span class="keyword">struct</span> evrpc_pool *pool,
<a name="l00428"></a>00428     <span class="keyword">struct</span> evhttp_connection *evcon);
<a name="l00429"></a>00429 
<a name="l00445"></a>00445 <span class="keywordtype">void</span> <a class="code" href="rpc_8h.html#a17dae9e4a25a500e521baf5a2c1c5c0a" title="Sets the timeout in secs after which a request has to complete.">evrpc_pool_set_timeout</a>(<span class="keyword">struct</span> evrpc_pool *pool, <span class="keywordtype">int</span> timeout_in_secs);
<a name="l00446"></a>00446 
<a name="l00452"></a><a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835b">00452</a> <span class="keyword">enum</span> <a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835b" title="Hooks for changing the input and output of RPCs; this can be used to implement compression...">EVRPC_HOOK_TYPE</a> {
<a name="l00453"></a><a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835ba2a62d2e1147edb5b460c1abb17be9734">00453</a>         <a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835ba2a62d2e1147edb5b460c1abb17be9734" title="apply the function to an input hook">EVRPC_INPUT</a>,            
<a name="l00454"></a><a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835bad63587ff3a66808e422f1ca48c9db85e">00454</a>         <a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835bad63587ff3a66808e422f1ca48c9db85e" title="apply the function to an output hook">EVRPC_OUTPUT</a>            
<a name="l00455"></a>00455 };
<a name="l00456"></a>00456 
<a name="l00457"></a>00457 <span class="preprocessor">#ifndef WIN32</span>
<a name="l00458"></a>00458 <span class="preprocessor"></span>
<a name="l00460"></a><a class="code" href="rpc_8h.html#a1bb283bd7893b9855e2f23013891fc82">00460</a> <span class="preprocessor">#define INPUT EVRPC_INPUT</span>
<a name="l00461"></a>00461 <span class="preprocessor"></span>
<a name="l00463"></a><a class="code" href="rpc_8h.html#a61a3c9a18380aafb6e430e79bf596557">00463</a> <span class="preprocessor">#define OUTPUT EVRPC_OUTPUT</span>
<a name="l00464"></a>00464 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00465"></a>00465 <span class="preprocessor"></span>
<a name="l00470"></a><a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338b">00470</a> <span class="keyword">enum</span> <a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338b" title="Return value from hook processing functions.">EVRPC_HOOK_RESULT</a> {
<a name="l00471"></a><a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338ba61de2cad490f408aa9ecc3427cfb6233">00471</a>         <a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338ba61de2cad490f408aa9ecc3427cfb6233" title="indicates the rpc should be terminated">EVRPC_TERMINATE</a> = -1,   
<a name="l00472"></a><a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338ba4f92aee79d3413c4940eeb578ee33643">00472</a>         <a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338ba4f92aee79d3413c4940eeb578ee33643" title="continue processing the rpc">EVRPC_CONTINUE</a> = 0,     
<a name="l00473"></a><a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338baff86ced7cf446eec75868ba64d956b9c">00473</a>         <a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338baff86ced7cf446eec75868ba64d956b9c" title="pause processing request until resumed">EVRPC_PAUSE</a> = 1         
<a name="l00474"></a>00474 };
<a name="l00475"></a>00475 
<a name="l00492"></a>00492 <span class="keywordtype">void</span> *<a class="code" href="rpc_8h.html#adb188728ddbaf5c85ac9e98d9d11a4a4" title="adds a processing hook to either an rpc base or rpc pool">evrpc_add_hook</a>(<span class="keywordtype">void</span> *vbase,
<a name="l00493"></a>00493     <span class="keyword">enum</span> <a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835b" title="Hooks for changing the input and output of RPCs; this can be used to implement compression...">EVRPC_HOOK_TYPE</a> hook_type,
<a name="l00494"></a>00494     <span class="keywordtype">int</span> (*cb)(<span class="keywordtype">void</span> *, <span class="keyword">struct</span> evhttp_request *, <span class="keyword">struct</span> <a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a> *, <span class="keywordtype">void</span> *),
<a name="l00495"></a>00495     <span class="keywordtype">void</span> *cb_arg);
<a name="l00496"></a>00496 
<a name="l00505"></a>00505 <span class="keywordtype">int</span> <a class="code" href="rpc_8h.html#a3969ea92840d165cab55a3228efcdbc6" title="removes a previously added hook">evrpc_remove_hook</a>(<span class="keywordtype">void</span> *vbase,
<a name="l00506"></a>00506     <span class="keyword">enum</span> <a class="code" href="rpc_8h.html#a66eff7ea6bdd17e53fde6c4d9dc1835b" title="Hooks for changing the input and output of RPCs; this can be used to implement compression...">EVRPC_HOOK_TYPE</a> hook_type,
<a name="l00507"></a>00507     <span class="keywordtype">void</span> *handle);
<a name="l00508"></a>00508 
<a name="l00514"></a>00514 <span class="keywordtype">int</span>
<a name="l00515"></a>00515 <a class="code" href="rpc_8h.html#a2724d98b6fc56d46cbfc9fe7ad9e6cf1" title="resume a paused request">evrpc_resume_request</a>(<span class="keywordtype">void</span> *vbase, <span class="keywordtype">void</span> *ctx, <span class="keyword">enum</span> <a class="code" href="rpc_8h.html#a9c37f133ebc96b2bd66c472079b1338b" title="Return value from hook processing functions.">EVRPC_HOOK_RESULT</a> res);
<a name="l00516"></a>00516 
<a name="l00528"></a>00528 <span class="keywordtype">void</span> <a class="code" href="rpc_8h.html#a1e6e536a5c57a2d87ffe778746906626" title="adds meta data to request">evrpc_hook_add_meta</a>(<span class="keywordtype">void</span> *ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> *key,
<a name="l00529"></a>00529     <span class="keyword">const</span> <span class="keywordtype">void</span> *data, <span class="keywordtype">size_t</span> data_size);
<a name="l00530"></a>00530 
<a name="l00541"></a>00541 <span class="keywordtype">int</span> <a class="code" href="rpc_8h.html#aad4ec382ca6789ac5bdc672420d98fc5" title="retrieves meta data previously associated">evrpc_hook_find_meta</a>(<span class="keywordtype">void</span> *ctx, <span class="keyword">const</span> <span class="keywordtype">char</span> *key,
<a name="l00542"></a>00542     <span class="keywordtype">void</span> **data, <span class="keywordtype">size_t</span> *data_size);
<a name="l00543"></a>00543 
<a name="l00550"></a>00550 <span class="keyword">struct </span>evhttp_connection *<a class="code" href="rpc_8h.html#a3aef04ab91e1af62675cd7d76fd06e94" title="returns the connection object associated with the request">evrpc_hook_get_connection</a>(<span class="keywordtype">void</span> *ctx);
<a name="l00551"></a>00551 
<a name="l00559"></a>00559 <span class="keywordtype">int</span> <a class="code" href="rpc_8h.html#a3d0c80cbf69003059bcdef4bfdbb321f" title="Function for sending a generic RPC request.">evrpc_send_request_generic</a>(<span class="keyword">struct</span> evrpc_pool *pool,
<a name="l00560"></a>00560     <span class="keywordtype">void</span> *request, <span class="keywordtype">void</span> *reply,
<a name="l00561"></a>00561     <span class="keywordtype">void</span> (*cb)(<span class="keyword">struct</span> evrpc_status *, <span class="keywordtype">void</span> *, <span class="keywordtype">void</span> *, <span class="keywordtype">void</span> *),
<a name="l00562"></a>00562     <span class="keywordtype">void</span> *cb_arg,
<a name="l00563"></a>00563     <span class="keyword">const</span> <span class="keywordtype">char</span> *rpcname,
<a name="l00564"></a>00564     <span class="keywordtype">void</span> (*req_marshal)(<span class="keyword">struct</span> <a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a> *, <span class="keywordtype">void</span> *),
<a name="l00565"></a>00565     <span class="keywordtype">void</span> (*rpl_clear)(<span class="keywordtype">void</span> *),
<a name="l00566"></a>00566     <span class="keywordtype">int</span> (*rpl_unmarshal)(<span class="keywordtype">void</span> *, <span class="keyword">struct</span> <a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a> *));
<a name="l00567"></a>00567 
<a name="l00575"></a>00575 <span class="keywordtype">int</span>
<a name="l00576"></a>00576 <a class="code" href="rpc_8h.html#a5987c57760de0cfb2639e36406ae99d8" title="Function for registering a generic RPC with the RPC base.">evrpc_register_generic</a>(<span class="keyword">struct</span> evrpc_base *base, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
<a name="l00577"></a>00577     <span class="keywordtype">void</span> (*callback)(<span class="keyword">struct</span> evrpc_req_generic *, <span class="keywordtype">void</span> *), <span class="keywordtype">void</span> *cbarg,
<a name="l00578"></a>00578     <span class="keywordtype">void</span> *(*req_new)(<span class="keywordtype">void</span> *), <span class="keywordtype">void</span> *req_new_arg, <span class="keywordtype">void</span> (*req_free)(<span class="keywordtype">void</span> *),
<a name="l00579"></a>00579     <span class="keywordtype">int</span> (*req_unmarshal)(<span class="keywordtype">void</span> *, <span class="keyword">struct</span> <a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a> *),
<a name="l00580"></a>00580     <span class="keywordtype">void</span> *(*rpl_new)(<span class="keywordtype">void</span> *), <span class="keywordtype">void</span> *rpl_new_arg, <span class="keywordtype">void</span> (*rpl_free)(<span class="keywordtype">void</span> *),
<a name="l00581"></a>00581     <span class="keywordtype">int</span> (*rpl_complete)(<span class="keywordtype">void</span> *),
<a name="l00582"></a>00582     <span class="keywordtype">void</span> (*rpl_marshal)(<span class="keyword">struct</span> <a class="code" href="structevbuffer.html" title="An evbuffer is an opaque data type for efficiently buffering data to be sent or received...">evbuffer</a> *, <span class="keywordtype">void</span> *));
<a name="l00583"></a>00583 
<a name="l00585"></a>00585 <span class="keyword">struct </span>evrpc_pool* <a class="code" href="rpc_8h.html#ab61cc3e97056faa013c3ad612e4ae763" title="accessors for obscure and undocumented functionality">evrpc_request_get_pool</a>(<span class="keyword">struct</span> evrpc_request_wrapper *ctx);
<a name="l00586"></a>00586 <span class="keywordtype">void</span> evrpc_request_set_pool(<span class="keyword">struct</span> evrpc_request_wrapper *ctx,
<a name="l00587"></a>00587     <span class="keyword">struct</span> evrpc_pool *pool);
<a name="l00588"></a>00588 <span class="keywordtype">void</span> evrpc_request_set_cb(<span class="keyword">struct</span> evrpc_request_wrapper *ctx,
<a name="l00589"></a>00589     <span class="keywordtype">void</span> (*cb)(<span class="keyword">struct</span> evrpc_status*, <span class="keywordtype">void</span> *request, <span class="keywordtype">void</span> *reply, <span class="keywordtype">void</span> *arg),
<a name="l00590"></a>00590     <span class="keywordtype">void</span> *cb_arg);
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00593"></a>00593 <span class="preprocessor"></span>}
<a name="l00594"></a>00594 <span class="preprocessor">#endif</span>
<a name="l00595"></a>00595 <span class="preprocessor"></span>
<a name="l00596"></a>00596 <span class="preprocessor">#endif </span><span class="comment">/* _EVENT2_RPC_H_ */</span>
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 17 Mar 2015 for libevent by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
